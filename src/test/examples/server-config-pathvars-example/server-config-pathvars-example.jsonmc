/*
 * Example configuration demonstrating path variable support in Freemarker templates
 *
 * This example shows how to use path variables extracted from the request URL
 * in Freemarker templates along with headers, body, and cookies.
 */
[
  {
    "server": {
      "serverId": "pathvars-demo",
      "port": 9001,
      "description": "Demo server for path variables in Freemarker templates"
    },
    "expectations": [
      {
        "httpRequest": {
          "method": "GET",
          "path": "/users/{id}",
          "pathParameters": {
            "id": "[a-zA-Z0-9\\-]+"
           }
        },
        "httpResponse": {
          "statusCode": 200,
          "headers": {
            "Content-Type": ["application/json"]
          },
          "body": {
            "userId": "${pathVariables.id}",
            "message": "User details retrieved",
            "requestedBy": "${headers['X-User-Name']!'anonymous'}"
          }
        }
      },
      {
        "httpRequest": {
          "method": "GET",
          "path": "/users/{userId}/posts/{postId}",
          "pathParameters": {
            "userId": "[a-zA-Z0-9\\-]+",
            "postId": "[a-zA-Z0-9\\-]+"
           }
        },
        "httpResponse": {
          "statusCode": 200,
          "headers": {
            "Content-Type": ["application/json"]
          },
          "body": {
            "userId": "${pathVariables.userId}",
            "postId": "${pathVariables.postId}",
            "title": "Post ${pathVariables.postId} by user ${pathVariables.userId}",
            "author": "${headers['X-Author-Name']!'Unknown'}",
            "timestamp": "${.now?iso_utc}"
          }
        }
      },
      {
        "httpRequest": {
          "method": "POST",
          "path": "/api/v1/organizations/{orgId}/projects/{projectId}/tasks",
          "pathParameters":{
            "orgId": "[a-zA-Z0-9\\-]+",
            "projectId": "[a-zA-Z0-9\\-]+"
          }
        },
        "httpResponse": {
          "statusCode": 201,
          "headers": {
            "Content-Type": ["application/json"],
            "Location": ["/api/v1/organizations/${pathVariables.orgId}/projects/${pathVariables.projectId}/tasks/new-task-123"]
          },
          "body": {
            "id": "new-task-123",
            "organizationId": "${pathVariables.orgId}",
            "projectId": "${pathVariables.projectId}",
            "title": "${body.title}",
            "description": "${body.description!'No description provided'}",
            "assignee": "${body.assignee!'Unassigned'}",
            "priority": "${body.priority!'medium'}",
            "createdBy": "${headers['X-User-Id']!'system'}",
            "createdAt": "${.now?iso_utc}"
          }
        }
      },
      {
        "httpRequest": {
          "method": "PUT",
          "path": "/users/{id}/profile",
          "pathParameters":{
            "id": "[a-zA-Z0-9\\-]+"
          }
        },
        "httpResponse": {
          "statusCode": 200,
          "headers": {
            "Content-Type": ["application/json"]
          },
          "body": {
            "userId": "${pathVariables.id}",
            "updatedFields": {
              "name": "${body.name}",
              "email": "${body.email}",
              "age": "${body.age}"
            },
            "updatedBy": "${headers['X-Admin-Id']!'self'}",
            "timestamp": "${.now?iso_utc}"
          }
        }
      },
      {
        "httpRequest": {
          "method": "DELETE",
          "path": "/users/{userId}/comments/{commentId}",
          "pathParameters":{
            "userId": "[a-zA-Z0-9\\-]+",
            "commentId": "[a-zA-Z0-9\\-]+"
          }
        },
        "httpResponse": {
          "statusCode": 200,
          "headers": {
            "Content-Type": ["application/json"]
          },
          "body": {
            "message": "Comment deleted successfully",
            "deletedCommentId": "${pathVariables.commentId}",
            "belongsToUserId": "${pathVariables.userId}",
            "deletedBy": "${headers['X-User-Id']!'unknown'}",
            "timestamp": "${.now?iso_utc}"
          }
        }
      },
      {
        "httpRequest": {
          "method": "GET",
          "path": "/api/v2/products/{category}/{productId}/reviews",
          "pathParameters":{
            "category": "[a-z]+",
            "productId": "[a-zA-Z0-9\\-]+"
          }
        },
        "httpResponse": {
          "statusCode": 200,
          "headers": {
            "Content-Type": ["application/json"]
          },
          "body": {
            "category": "${pathVariables.category}",
            "productId": "${pathVariables.productId}",
            "reviews": [
              {
                "id": "review-1",
                "rating": 5,
                "comment": "Great ${pathVariables.category} product!"
              },
              {
                "id": "review-2",
                "rating": 4,
                "comment": "Good value for product ${pathVariables.productId}"
              }
            ],
            "totalReviews": 2,
            "requestedBy": "${headers['User-Agent']!'Unknown Client'}"
          }
        }
      }
    ]
  }
]
